<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Crop Yield Comparison</title>

  <!-- Shared CSS -->
  <link rel="stylesheet" href="/css/nav.css"/>
  <link rel="stylesheet" href="/css/style.css"/>
  
</head>

<body>
  <header>
    <h1>Global Crop Yield Sustainability</h1>
    <p>Visualizing food production efficiency over time (1981–2016)</p>
  </header>

  <nav>
    <a href="/">Home</a>
    <a href="/yields/crop/maize">By Crop</a>
    <a href="/yields/year/2000">By Year</a>
    <a href="/yields/compare">Compare</a>
  </nav>

  <main>
    <h2>Crop Yield Comparison (1981–2016)</h2>
    <canvas id="compareChart"></canvas>
  </main>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    let chartData = $$$CHART_DATA$$$;

    const years = [...new Set(chartData.map(r => r.year))];
    const crops = ["maize", "wheat", "rice"];

    const datasets = crops.map(crop => ({
      label: crop.charAt(0).toUpperCase() + crop.slice(1),
      data: years.map(y => {
        const row = chartData.find(r => r.crop === crop && r.year === y);
        return row ? row.avg_yield : null;
      }),
      borderWidth: 2,
      fill: false,
      tension: 0.25, // smoother curves
      pointRadius: 3
    }));

    new Chart(document.getElementById("compareChart"), {
      type: "line",
      data: { labels: years, datasets: datasets },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: { position: "top" },
          title: {
            display: true,
            text: "Crop Yields Over Time (tons per hectare)",
            font: { size: 18 }
          }
        },
        scales: {
          x: {
            title: {
              display: true,
              text: "Year",
              font: { size: 14 }
            },
            ticks: { maxRotation: 45, minRotation: 45 }
          },
          y: {
            title: {
              display: true,
              text: "Average Yield (tons per hectare)",
              font: { size: 14 }
            },
            beginAtZero: true
          }
        }
      }
    });
  </script>
</body>
</html>
